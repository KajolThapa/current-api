{"code":"!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var o in e)t.d(r,o,function(t){return e[t]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=0)}([function(e,t,n){n(1)},function(e,t,n){\"use strict\";function r(e,t,n){var r={},o=null;return e[t]&&f(e[t])?o=e[t]:e[t]&&u(e[t])&&(r=e[t]),o||\"function\"!=typeof e[n]||(o=e[n]),{options:r,callback:o}}function o(e,t,n,r){if(!e)return[];var o=e.split(\" \").map(function(e){return function(e,t,n){null==t&&(t=h.DEFAULT_MIN_SIZE);var r,o=new Set;if(0>=t)throw new Error(\"minSize must be greater than 0.\");if(!e)return[];if(e=e.slice?e.toLowerCase():e+\"\",r=n?0:e.length-t+1,e.length<=t)return[e];if(!n&&1>r)return[];if(n){for(;t<e.length+1;)o.add(e.slice(r,r+t)),t++;return Array.from(o)}for(;t<=e.length+1;)0===r?(t++,r=e.length-t+1):o.add(e.slice(--r,r+t));return Array.from(o)}(function(e,t){return e=e.toLowerCase(),t&&(e=e.replace(/[!\\\"#%&\\'\\(\\)\\*\\+,-\\.\\/:;<=>?@\\[\\\\\\]\\^`\\{\\|\\}~]/g,\"\")),e=e.replace(/_/g,\" \"),e=m(e)}(e,t),n||h.DEFAULT_MIN_SIZE,r||h.DEFAULT_PREFIX_ONLY)}).reduce(function(e,t){return e.concat(t)},[]);return Array.from(new Set(o))}function i(e,t){return t.type=e,t}function u(e){return!!e&&e.constructor===Object&&0<Object.keys(e).length}function f(e){return!(!e||!(\"function\"==typeof e||e instanceof Function))}function a(e){return Object.keys(e).map(function(t){return e[t]})}function c(e){return{[`${e}_fuzzy`]:i([String],{default:\"\",index:!1})}}function s(e,t,n,r){e.forEach(function(e){if(\"string\"==typeof e||e instanceof String&&f(t))t(e);else{if(!u(e))throw new TypeError(\"Fields items must be String or Object.\");e.keys&&f(r)?r(e):f(n)&&n(e)}})}function l(e,t){var n={},r={};s(t,function(t){e.add(c(t)),n[`${t}_fuzzy`]=\"text\"},function(t){e.add(c(t.name)),n[`${t.name}_fuzzy`]=\"text\",t.weight&&(r[`${t.name}_fuzzy`]=t.weight)},function(t){t.keys.forEach(e=>{n[`${t.name}_fuzzy.${e}_fuzzy`]=\"text\"}),e.add(function(e){return{[`${e}_fuzzy`]:i(d.Schema.Types.Mixed,{default:[],index:!1})}}(t.name))}),e.index(n,{weights:r})}function y(e,t){s(t,function(t){e[t]&&(e[`${t}_fuzzy`]=o(e[t]))},function(t){if(e[`${t.name}`]){var n=!1!==t.escapeSpecialCharacters;e[`${t.name}_fuzzy`]=o(e[t.name],n,t.minSize,t.prefixOnly)}},function(t){if(e[`${t.name}`]){var n=!1!==t.escapeSpecialCharacters,r=[];e[t.name].forEach(function(e){var i={};t.keys.forEach(function(r){i=Object.assign({},i,{[`${r}_fuzzy`]:o(e[r],n,t.minSize,t.prefixOnly)})}),r.push(i)}),e[`${t.name}_fuzzy`]=r}})}var d=n(2),p=d.Model,m=(d.model,n(3)),h={DEFAULT_MIN_SIZE:2,DEFAULT_PREFIX_ONLY:!1};e.exports=function(e,t){function n(e){this._update&&(y(this._update,t.fields),e())}if(!t||t&&!t.fields)throw new Error(\"You must set at least one field for fuzzy search.\");if(!Array.isArray(t.fields))throw new TypeError(\"Fields must be an array.\");t.fields.forEach(function(e){if(u(e)&&e.keys&&!Array.isArray(e.keys)&&\"string\"!=typeof e.keys)throw new TypeError(\"Key must be an array or a string.\")}),l(e,t.fields);var i={transform:function(e){return function(t,n){return s(e,function(e){delete n[`${e}_fuzzy`]},function(e){delete n[`${e.name}_fuzzy`]}),n}}(t.fields),getters:!0,setters:!0,virtuals:!0};e.set(\"toObject\",i),e.set(\"toJSON\",i),e.pre(\"save\",function(e){this&&(y(this,t.fields),e())}),e.pre(\"update\",n),e.pre(\"findOneAndUpdate\",n),e.pre(\"insertMany\",function(e,n){n.forEach(function(e){y(e,t.fields)}),e()}),e.pre(\"updateMany\",n),e.statics.fuzzySearch=function(){Object.values=Object.values||a;var e=Object.values(arguments);if(0===e.length&&(\"string\"!=typeof e[0]||!u(e[0])))throw new TypeError(\"Fuzzy Search: First argument is mandatory and must be a string or an object.\");var t,n=u(e[0])?e[0].query:e[0],i=u(e[0])?e[0].prefixOnly:h.DEFAULT_PREFIX_ONLY,f=o(n,!1,u(e[0])?e[0].minSize:h.DEFAULT_MIN_SIZE,i).join(\" \"),c=r(e,1,2),s=c.options,l=c.callback;return t=s?{$and:[{$text:{$search:f}},s]}:{$text:{$search:f}},p.find.apply(this,[t,{confidenceScore:{$meta:\"textScore\"}},{sort:{confidenceScore:{$meta:\"textScore\"}}},l])}}},function(e){e.exports=mongoose},function(e){\"use strict\";function t(e,t){var r=!1,o=null;return t?((\"α\"===e||\"ε\"===e||\"γ\"===e||\"η\"===e)&&(r=!!(o=n[`${e}${t}`])),{letter:o||n[e],found:r}):{letter:n[e],found:r}}var n={\"α\":\"a\",\"ά\":\"a\",\"αυ\":\"af\",\"αύ\":\"af\",\"à\":\"a\",\"á\":\"a\",\"â\":\"a\",\"ã\":\"a\",\"ä\":\"a\",\"å\":\"a\",\"ą\":\"a\",\"β\":\"v\",\"ß\":\"s\",\"ç\":\"c\",\"γ\":\"g\",\"γγ\":\"ng\",\"γκ\":\"gk\",\"γξ\":\"nx\",\"δ\":\"d\",\"ð\":\"d\",\"ε\":\"e\",\"æ\":\"e\",\"έ\":\"e\",\"ευ\":\"ev\",\"εύ\":\"ev\",\"è\":\"e\",\"é\":\"e\",\"ê\":\"e\",\"ë\":\"e\",\"ζ\":\"z\",\"η\":\"i\",\"ή\":\"i\",\"ηυ\":\"if\",\"θ\":\"th\",\"ι\":\"i\",\"ί\":\"i\",\"ϊ\":\"i\",\"ἰ\":\"i\",\"ΐ\":\"i\",\"ì\":\"i\",\"í\":\"i\",\"î\":\"i\",\"ï\":\"i\",\"κ\":\"k\",\"λ\":\"l\",\"μ\":\"m\",\"ν\":\"n\",\"ñ\":\"n\",\"ξ\":\"ks\",\"ο\":\"o\",\"ό\":\"o\",\"ò\":\"o\",\"ó\":\"o\",\"ô\":\"o\",\"õ\":\"o\",\"ö\":\"o\",\"ø\":\"o\",\"π\":\"p\",\"þ\":\"p\",\"ρ\":\"r\",\"σ\":\"s\",\"ς\":\"s\",\"τ\":\"t\",\"υ\":\"u\",\"ύ\":\"u\",\"ϋ\":\"u\",\"ΰ\":\"u\",\"ù\":\"u\",\"ú\":\"u\",\"û\":\"u\",\"ü\":\"u\",\"φ\":\"f\",\"ý\":\"y\",\"ÿ\":\"y\",\"χ\":\"ch\",\"ψ\":\"ps\",\"ω\":\"o\",\"ώ\":\"o\"};e.exports=function(e){if(!e)return\"\";var r=\"\",o=0;for(e=e.toLowerCase();o<e.length;){var i=!1,u=e[o],f=e[o+1];if(n[u]){var{letter:a,found:c}=t(u,f);r+=a,i=c}else r+=u;i?o+=2:o++}return r}}]);","extractedComments":[]}